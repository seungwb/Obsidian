---
tags:
  - NetworkStudy
---
## HTTP 란?

---

- 클라이언트와 서버간에 데이터를 주고 받기 위한 통신 프로토콜로, 현재는 텍스트뿐만 아니라 이미지, 음성, 영상, 파일, API 요청 등 거의 모든 형태의 데이터를 HTTP를 통해 전송한다.
- HTTP/1.1 버전이 가장 널리 사용되며, 성능이 개선된 HTTP/2와, TCP 대신 UDP를 사용하는 HTTP/3가 최신 버전이다.
	- TCP: HTTP/1.1, HTTP/2
	- UDP: HTTP/3

## HTTP 특징

---

- 클라이언트 서버 구조
- 무상태 프로토콜(stateless), 비연결성(connectionless)
- 단순함, 확장 가능성
- HTTP 메시지 기반 통신

## 클라이언트 서버 구조

---

- 클라이언트가 Request (요청)을 보내면 서버가 그 요청을 받아 Response (응답) 한다. 클라이언트는 서버의 응답을 받아 처리한다.

## 무상태 프로토콜 (Stateless)

---

- 서버가 클라이언트의 상태를 보존하지 않는다.
- 장점: 서버 확장성이 높다 (스케일 아웃에 유리)
- 단점: 클라이언트가 상황에 맞는 모든 데이터를 전송하여야 한다.

#### 모든 것을 무상태로 설계 하여야 할까?

- 이상적으로는 무상태로 설계하는 것이 좋지만, 로그인 등 상태 유지가 필요한 경우에는 쿠키, 세션 등으로 상태를 관리해야 한다(**Stateful**).
- 필수적인 상황이 아니라면 **Stateless** 구조로 설계하는 것이 바람직하다.

## 비 연결성 (connectionless)

---

- HTTP는 기본적으로 요청-응답이 끝나면 연결을 종료한다.
- 만약 클라이언트와 TCP/IP 연결을 계속 유지한다면 서버 자원 소모가 커진다.
- 비연결성 덕분에 수많은 사용자가 동시에 서비스를 이용해도 실제 서버가 유지하는 연결 수는 제한적이다.

#### 비연결성의 단점

- 요청마다 TCP/IP 연결을 새로 맺어야 하므로 3-way handshake 등 추가 시간이 든다.
- 이를 보완하기 위해 HTTP/1.1부터는 지속 연결(Persistent Connections)이 도입되었고, HTTP/2, HTTP/3에서는 더욱 최적화되었다.

## HTTP 메시지

---

>HTTP 메시지는 클라이언트와 서버가 데이터를 교환하는 기본 단위로, 다음과 같은 구조를 가진다
1. **시작 줄(Start-Line)**: 요청 메시지에서는 요청 라인, 응답 메시지에서는 상태 라인.
2. **헤더(Headers)**: 메시지에 대한 부가 정보를 담는 영역.
3. **공백 줄(빈 줄)**: 헤더와 본문을 구분.
4. **본문(Body, 선택적)**: 실제 데이터가 담기는 영역.


### HTTP 요청 (request)

#### 시작 줄 (start-line)

- **HTTP 메서드**: GET, POST, PUT, DELETE 등
- **요청 대상(Request Target)**: 요청할 자원의 경로(예: /search?q=hello&hl=ko)
- **HTTP 버전**: 예시 - HTTP/1.1
```text
GET /search?q=hello&hl=ko HTTP/1.1
```

#### Header

- 헤더는 요청에 대한 추가 정보(메타데이터)를 제공한다.
- 헤더는 `key: value` 형식으로, 대소문자를 구분하지 않는다.
- 주요 요청 헤더 예시:
    - `Host`: 요청 대상 서버의 도메인
    - `User-Agent`: 요청을 보내는 클라이언트 정보
    - `Accept`: 클라이언트가 허용하는 응답 콘텐츠 타입
    - `Authorization`: 인증 정보
    - `Content-Type`: 본문 데이터의 타입(POST, PUT 등에서 사용)
    - `Cookie`: 클라이언트의 쿠키 정보
- 헤더는 요청의 처리 방식, 인증, 캐싱, 콘텐츠 협상 등 다양한 기능을 지원한다
#### Body

- 본문은 선택적이며, 주로 POST, PUT, PATCH 등에서 데이터를 서버로 전송할 때 사용된다.
- 본문에는 폼 데이터, JSON, 파일 등 다양한 데이터가 포함될 수 있다.
- GET 요청 등에서는 보통 본문을 사용하지 않는다

### HTTP 응답 (response)

#### 시작줄 (status line) 

- **HTTP 버전**: 예시 - HTTP/1.1
- **상태 코드(Status Code)**: 3자리 숫자(예: 200, 404, 201 등)
- **상태 텍스트(Status Text)**: 상태 코드에 대한 간단한 설명(예: OK, Not Found)
- 
```text
HTTP/1.1 200 OK
```

#### Header

- 응답에 대한 부가 정보를 제공한다.
- 주요 응답 헤더 예시:
    - `Content-Type`: 응답 본문의 데이터 타입(예: text/html, application/json 등)
    - `Content-Length`: 본문의 길이(바이트 단위)
    - `Set-Cookie`: 클라이언트에 쿠키 설정
    - `Cache-Control`: 캐싱 정책
    - `Location`: 리다이렉트 시 새로운 위치
    - `Server`: 서버 소프트웨어 정보
    - `Date`: 응답이 생성된 시간
- 헤더는 클라이언트가 응답을 해석하거나, 추가 요청을 할 때 필요한 정보를 제공한다

#### Body

- Body는 실제 응답 데이터가 담기는 부분이다.
- HTML, JSON, 이미지, 동영상, 파일 등 다양한 데이터가 들어갈 수 있다.
- 상태 코드에 따라 본문이 없는 경우도 있다(예: 204 No Content, 304 Not Modified, HEAD 메서드 응답 등).
- Body가 존재할 경우, `Content-Type` 헤더를 통해 데이터 형식을 반드시 명시해야 하며, `Content-Length`로 크기를 알릴 수 있다
